"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getAstNodes = void 0;

var _libpg_enums = _interopRequireDefault(require("./libpg_enums"));

var _libpg_structs = _interopRequireDefault(require("./libpg_structs"));

var astNodes;

var getAstNodes = function getAstNodes() {
  if (astNodes) return astNodes;
  var nodes = _libpg_structs["default"]['nodes/parsenodes'];
  astNodes = Object.keys(nodes).reduce(function (m, key) {
    var obj = nodes[key].fields.reduce(function (m2, field) {
      if (!field.name) {
        return m2;
      }

      var type = field.c_type.replace(/\*$/, '');
      var nested = false;
      var isEnum = false;

      if (_libpg_structs["default"]['nodes/parsenodes'].hasOwnProperty(type)) {
        nested = true;
      }

      if (_libpg_enums["default"]['nodes/parsenodes'].hasOwnProperty(type)) {
        isEnum = true;
      }

      m2[field.name] = {
        type: type
      };
      if (nested) m2[field.name].nested = nested;
      if (isEnum) m2[field.name]["enum"] = isEnum;
      return m2;
    }, {});
    m[key] = obj;
    return m;
  }, {});
  return astNodes;
};

exports.getAstNodes = getAstNodes;